// azan.js
// Auto Azan notification in ALL groups (Manual time version)
// File: modules/commands/azan.js

const schedule = require("node-schedule");

module.exports.config = {
  name: "azan",
  version: "3.5.0",
  hasPermssion: 0,
  credits: "Akash + Saiful Edit",
  description: "ржкрзНрж░рждрж┐ржжрж┐ржи ржЖржЬрж╛ржи ржУ ржирж╛ржорж╛ржЬрзЗрж░ рж╕ржорзЯ рж╕ржм ржЧрзНрж░рзБржкрзЗ ржЕржЯрзЛ ржирзЛржЯрж┐ржлрж┐ржХрзЗрж╢ржи ржкрж╛ржарж╛ржмрзЗ",
  commandCategory: "Islamic",
  usages: "ржЕржЯрзЛ рж░рж╛ржи",
  cooldowns: 5
};

let jobs = [];

module.exports.onLoad = async function({ api }) {
  // ржЖржЬрж╛ржирзЗрж░ ржЯрж╛ржЗржо (ржмрж╛ржВрж▓рж╛ржжрзЗрж╢ рж╕рзНржЯрзНржпрж╛ржирзНржбрж╛рж░рзНржб ржЯрж╛ржЗржо)
  const prayerTimes = {
    "рждрж╛рж╣рж╛ржЬрзНржЬрзБржж": { time: "02:30", msg: 
`тХФтХРтЭЦЁЯММтЭЦтХРтХЧ
ЁЯХМ рждрж╛рж╣рж╛ржЬрзНржЬрзБржж ржирж╛ржорж╛ржЬ
тХЪтХРтЭЦЁЯММтЭЦтХРтХЭ
тЬи рж░рж╛рждрзЗрж░ рж╢рзЗрж╖ ржнрж╛ржЧрзЗрж░ рж╕рзЗрж░рж╛ ржЗржмрж╛ржжрждред
тЬи ржпрж╛рж░рж╛ рждрж╛рж╣рж╛ржЬрзНржЬрзБржж ржкрзЬрзЗ, ржЖрж▓рзНрж▓рж╛рж╣ рждрж╛ржжрзЗрж░ ржжрзЛрзЯрж╛ ржХржмрзБрж▓ ржХрж░рзЗржиред
ЁЯССЁЭРБЁЭРиЁЭРн ЁЭРОЁЭР░ЁЭРзЁЭРЮЁЭРл тЮа ЁЭРТЁЭРАЁЭРИЁЭРЕЁЭРФЁЭРЛ ЁЭРИЁЭРТЁЭРЛЁЭРАЁЭРМ
ЁЯМЯ ЁЭРВЁЭРлЁЭРЮЁЭРЪЁЭРнЁЭРиЁЭРл тФБ ЁЭРТЁЭРЪЁЭРвЁЭРЯЁЭРоЁЭРе ЁЭРИЁЭРмЁЭРеЁЭРЪЁЭРж ЁЯМЯ` },

    "ржлржЬрж░": { time: "04:24", msg: 
`тХФтХРтЭЦЁЯМЕтЭЦтХРтХЧ
ЁЯХМ ржлржЬрж░ ржирж╛ржорж╛ржЬ
тХЪтХРтЭЦЁЯМЕтЭЦтХРтХЭ
тЬи ржШрзБржо ржнрж╛ржЩрж╛рж░ ржкрж░ ржпрзЗ рж╕рзЗржЬржжрж╛, рж╕рзЗржЯрж╛ржЗ ржЖрж╕рж▓ ржмрж┐ржЬрзЯред
тЬи ржнрзЛрж░рзЗрж░ ржЖрж▓рзЛрзЯ ржирж╛ржорж╛ржЬ ржорж╛ржирзЗ рж░рж╣ржоржд ржЖрж░ ржкрзНрж░рж╢рж╛ржирзНрждрж┐ред
ЁЯССЁЭРБЁЭРиЁЭРн ЁЭРОЁЭР░ЁЭРзЁЭРЮЁЭРл тЮа ЁЭРТЁЭРАЁЭРИЁЭРЕЁЭРФЁЭРЛ ЁЭРИЁЭРТЁЭРЛЁЭРАЁЭРМ
ЁЯМЯ ЁЭРВЁЭРлЁЭРЮЁЭРЪЁЭРнЁЭРиЁЭРл тФБ ЁЭРТЁЭРЪЁЭРвЁЭРЯЁЭРоЁЭРе ЁЭРИЁЭРмЁЭРеЁЭРЪЁЭРж ЁЯМЯ` },

    "ржпрзЛрж╣рж░": { time: "13:00", msg: 
`тХФтХРтЭЦтШАя╕ПтЭЦтХРтХЧ
ЁЯХМ ржпрзЛрж╣рж░ ржЖржЬрж╛ржи
тХЪтХРтЭЦтШАя╕ПтЭЦтХРтХЭ
тЬи ржжрж┐ржирзЗрж░ ржмрзНржпрж╕рзНрждрждрж╛рж░ ржорж╛ржЭрзЗржЗ рж╢рж╛ржирзНрждрж┐рж░ ржбрж╛ржХред
тЬи рж░рзЛржжрзЗрж░ рждрж╛ржкрзЗ рж╕рзЗржЬржжрж╛ ржорж╛ржирзЗ ржарж╛ржгрзНржбрж╛ рж╕рзБржЦред
ЁЯССЁЭРБЁЭРиЁЭРн ЁЭРОЁЭР░ЁЭРзЁЭРЮЁЭРл тЮа ЁЭРТЁЭРАЁЭРИЁЭРЕЁЭРФЁЭРЛ ЁЭРИЁЭРТЁЭРЛЁЭРАЁЭРМ
ЁЯМЯ ЁЭРВЁЭРлЁЭРЮЁЭРЪЁЭРнЁЭРиЁЭРл тФБ ЁЭРТЁЭРЪЁЭРвЁЭРЯЁЭРоЁЭРе ЁЭРИЁЭРмЁЭРеЁЭРЪЁЭРж ЁЯМЯ` },

    "ржЖрж╕рж░": { time: "16:17", msg: 
`тХФтХРтЭЦЁЯМЗтЭЦтХРтХЧ
ЁЯХМ ржЖрж╕рж░ ржЖржЬрж╛ржи
тХЪтХРтЭЦЁЯМЗтЭЦтХРтХЭ
тЬи ржмрж┐ржХрзЗрж▓рзЗрж░ рж╕рзЛржирж╛рж▓рзА ржЖрж▓рзЛрзЯ ржжрзЛрзЯрж╛рж░ рж╢рж╛ржирзНрждрж┐ред
тЬи ржЖрж╕рж░ ржЫрж╛рзЬрж╛ ржжрж┐ржирзЗрж░ ржЗржмрж╛ржжржд ржЕрж╕ржорзНржкрзВрж░рзНржгред
ЁЯССЁЭРБЁЭРиЁЭРн ЁЭРОЁЭР░ЁЭРзЁЭРЮЁЭРл тЮа ЁЭРТЁЭРАЁЭРИЁЭРЕЁЭРФЁЭРЛ ЁЭРИЁЭРТЁЭРЛЁЭРАЁЭРМ
ЁЯМЯ ЁЭРВЁЭРлЁЭРЮЁЭРЪЁЭРнЁЭРиЁЭРл тФБ ЁЭРТЁЭРЪЁЭРвЁЭРЯЁЭРоЁЭРе ЁЭРИЁЭРмЁЭРеЁЭРЪЁЭРж ЁЯМЯ` },

    "ржорж╛ржЧрж░рж┐ржм": { time: "17:47", msg: 
`тХФтХРтЭЦЁЯМЩтЭЦтХРтХЧ
ЁЯХМ ржорж╛ржЧрж░рж┐ржм ржЖржЬрж╛ржи
тХЪтХРтЭЦЁЯМЩтЭЦтХРтХЭ
тЬи рж╕рзВрж░рзНржпрж╛рж╕рзНрждрзЗрж░ ржкрж░ ржкрзНрж░ржержо рж╕рзЗржЬржжрж╛рж░ ржирзВрж░ред
тЬи ржорж╛ржЧрж░рж┐ржмрзЗржЗ ржжрж┐ржирзЗрж░ ржХрзНрж▓рж╛ржирзНрждрж┐ ржорзБржЫрзЗ ржпрж╛рзЯред
ЁЯССЁЭРБЁЭРиЁЭРн ЁЭРОЁЭР░ЁЭРзЁЭРЮЁЭРл тЮа ЁЭРТЁЭРАЁЭРИЁЭРЕЁЭРФЁЭРЛ ЁЭРИЁЭРТЁЭРЛЁЭРАЁЭРМ
ЁЯМЯ ЁЭРВЁЭРлЁЭРЮЁЭРЪЁЭРнЁЭРиЁЭРл тФБ ЁЭРТЁЭРЪЁЭРвЁЭРЯЁЭРоЁЭРе ЁЭРИЁЭРмЁЭРеЁЭРЪЁЭРж ЁЯМЯ` },

    "ржЗрж╢рж╛": { time: "19:17", msg: 
`тХФтХРтЭЦЁЯММтЭЦтХРтХЧ
ЁЯХМ ржЗрж╢рж╛ ржЖржЬрж╛ржи
тХЪтХРтЭЦЁЯММтЭЦтХРтХЭ
тЬи рж░рж╛рждрзЗрж░ ржЖржБржзрж╛рж░рзЗ рж╕рзЗрж░рж╛ ржЗржмрж╛ржжрждрзЗрж░ ржкрзНрж░рж╢рж╛ржирзНрждрж┐ред
тЬи ржЗрж╢рж╛рж░ рж╕рзЗржЬржжрж╛ ржорж╛ржирзЗ ржШрзБржорж╛ржирзЛрж░ ржЖржЧрзЗ ржЬрж╛ржирзНржирж╛рждрзЗрж░ ржкрзНрж░рж╕рзНрждрзБрждрж┐ред
ЁЯССЁЭРБЁЭРиЁЭРн ЁЭРОЁЭР░ЁЭРзЁЭРЮЁЭРл тЮа ЁЭРТЁЭРАЁЭРИЁЭРЕЁЭРФЁЭРЛ ЁЭРИЁЭРТЁЭРЛЁЭРАЁЭРМ
ЁЯМЯ ЁЭРВЁЭРлЁЭРЮЁЭРЪЁЭРнЁЭРиЁЭРл тФБ ЁЭРТЁЭРЪЁЭРвЁЭРЯЁЭРоЁЭРе ЁЭРИЁЭРмЁЭРеЁЭРЪЁЭРж ЁЯМЯ` }
  };

  // ржкрзНрж░рждрж┐ржжрж┐ржирзЗрж░ ржУрзЯрж╛ржХрзНржд
  for (let [prayer, { time, msg }] of Object.entries(prayerTimes)) {
    const [hour, minute] = time.split(":").map(Number);

    const job = schedule.scheduleJob({ hour, minute, tz: "Asia/Dhaka" }, function () {
      const today = new Date();
      const day = today.getDay(); // Sunday = 0 ... Friday = 5

      // рж╢рзБржХрзНрж░рж╛ржмрж╛рж░ рж╣рж▓рзЗ ржпрзЛрж╣рж░ рж╕рзНржХрж┐ржк ржХрж░рждрзЗ рж╣ржмрзЗ
      if (day === 5 && prayer === "ржпрзЛрж╣рж░") return;

      for (const threadID of global.data.allThreadID) {
        api.sendMessage(msg, threadID);
      }
    });

    jobs.push(job);
  }

  // ржЬрзБржорж╛рж░ ржирж╛ржорж╛ржЬ (рж╢рзБржзрзБ рж╢рзБржХрзНрж░ржмрж╛рж░ 12:45 ржП)
  const jumuahJob = schedule.scheduleJob({ dayOfWeek: 5, hour: 12, minute: 45, tz: "Asia/Dhaka" }, function () {
    const jumuahMsg = 
`тХФтХРтЭЦЁЯХМтЭЦтХРтХЧ
тЬи ржЬрзБржорж╛рж░ ржЖржЬрж╛ржи тЬи
тХЪтХРтЭЦЁЯХМтЭЦтХРтХЭ
ЁЯд▓ ржЖржЬ рж╢рзБржХрзНрж░ржмрж╛рж░ред
ЁЯХМ рж╕ржмрж╛ржЗ рж╕рзБржирзНржжрж░ржнрж╛ржмрзЗ ржкрзНрж░рж╕рзНрждрзБрждрж┐ ржирж┐рзЯрзЗ
ржорж╕ржЬрж┐ржжрзЗ ржЧрж┐рзЯрзЗ ржЬрзБржорж╛рж░ ржирж╛ржорж╛ржЬ ржЖржжрж╛рзЯ ржХрж░рзБржиред
ЁЯУЦ рж╕рзВрж░рж╛ ржХрж╛рж╣ржл ржкрзЬрждрзЗ ржнрзБрж▓ржмрзЗржи ржирж╛ред
ЁЯССЁЭРБЁЭРиЁЭРн ЁЭРОЁЭР░ЁЭРзЁЭРЮЁЭРл тЮа ЁЭРТЁЭРАЁЭРИЁЭРЕЁЭРФЁЭРЛ ЁЭРИЁЭРТЁЭРЛЁЭРАЁЭРМ
ЁЯМЯ ЁЭРВЁЭРлЁЭРЮЁЭРЪЁЭРнЁЭЧ╝ЁЭЧ┐ тФБ ЁЭРТЁЭРЪЁЭРвЁЭРЯЁЭРоЁЭРе ЁЭРИЁЭРмЁЭРеЁЭРЪЁЭРж ЁЯМЯ`;

    for (const threadID of global.data.allThreadID) {
      api.sendMessage(jumuahMsg, threadID);
    }
  });

  jobs.push(jumuahJob);

  console.log("тЬЕ ржЖржЬрж╛ржи ржирзЛржЯрж┐ржлрж┐ржХрзЗрж╢ржи + рждрж╛рж╣рж╛ржЬрзНржЬрзБржж + ржЬрзБржорж╛рж░ рж╕рж┐рж╕рзНржЯрзЗржо ржЪрж╛рж▓рзБ рж╣рзЯрзЗржЫрзЗ (рж╕ржм ржЧрзНрж░рзБржкрзЗ)ред");
};

module.exports.run = async function() {
  // ржХрзЛржирзЛ ржХржорж╛ржирзНржб ржжрж░ржХрж╛рж░ ржирзЗржЗ, ржЕржЯрзЛ ржЪрж▓ржмрзЗ
};
