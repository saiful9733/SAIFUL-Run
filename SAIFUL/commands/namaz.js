// namaz.js
// Auto Namaz notification in ALL groups (Manual time version)
// File: modules/commands/namaz.js

const schedule = require("node-schedule");

module.exports.config = {
  name: "namaz",
  version: "1.0.1",
  hasPermssion: 0,
  credits: "Akash + Saiful Edit",
  description: "ржкрзНрж░рждрж┐ржжрж┐ржи ржирж╛ржорж╛ржЬрзЗрж░ рж╕ржорзЯ рж╕ржм ржЧрзНрж░рзБржкрзЗ ржЕржЯрзЛ ржирзЛржЯрж┐ржлрж┐ржХрзЗрж╢ржи ржкрж╛ржарж╛ржмрзЗ",
  commandCategory: "Islamic",
  usages: "ржЕржЯрзЛ рж░рж╛ржи",
  cooldowns: 5
};

let jobs = [];

module.exports.onLoad = async function({ api }) {
  // ржирж╛ржорж╛ржЬ ржЯрж╛ржЗржо (ржмрж╛ржВрж▓рж╛ржжрзЗрж╢ рж╕рзНржЯрзНржпрж╛ржирзНржбрж╛рж░рзНржб ржЯрж╛ржЗржо)
  const prayerTimes = {
    "ржлржЬрж░": { time: "04:42", msg: 
`тХФтХРтЭЦЁЯМЕтЭЦтХРтХЧ
ЁЯХМ ржлржЬрж░ ржирж╛ржорж╛ржЬ
тХЪтХРтЭЦЁЯМЕтЭЦтХРтХЭ
тП░ рж╕ржоржпрж╝ рж╢рзЗрж╖ рж╣рждрзЗ ржЪрж▓рзЗржЫрзЗ! ржлржЬрж░рзЗрж░ ржирж╛ржорж╛ржЬрзЗрж░ ржЬржирзНржп ржкрзНрж░рж╕рзНрждрзБржд рж╣рзЛржиред
ЁЯССЁЭРБЁЭРиЁЭРн ЁЭРОЁЭР░ЁЭРзЁЭРЮЁЭРл тЮа ЁЭРТЁЭРАЁЭРИЁЭРЕЁЭРФЁЭРЛ ЁЭРИЁЭРТЁЭРЛЁЭРАЁЭРМ
ЁЯМЯ ЁЭРВЁЭРлЁЭРЮЁЭРЪЁЭРнЁЭЧ╝ЁЭЧ┐ тФБ ЁЭРТЁЭРЪЁЭРвЁЭРЯЁЭРоЁЭРе ЁЭРИЁЭРмЁЭРеЁЭРЪЁЭРж ЁЯМЯ` },

    "ржпрзЛрж╣рж░": { time: "13:28", msg: 
`тХФтХРтЭЦтШАя╕ПтЭЦтХРтХЧ
ЁЯХМ ржпрзЛрж╣рж░ ржирж╛ржорж╛ржЬ
тХЪтХРтЭЦтШАя╕ПтЭЦтХРтХЭ
тП░ рж╕ржоржпрж╝ рж╢рзЗрж╖ рж╣рждрзЗ ржЪрж▓рзЗржЫрзЗ! ржЬрзЛрж╣рж░рзЗрж░  ржирж╛ржорж╛ржЬрзЗрж░ ржЬржирзНржп ржкрзНрж░рж╕рзНрждрзБржд рж╣рзЛржиред
ЁЯССЁЭРБЁЭРиЁЭРн ЁЭРОЁЭР░ЁЭРзЁЭРЮЁЭРл тЮа ЁЭРТЁЭРАЁЭРИЁЭРЕЁЭРФЁЭРЛ ЁЭРИЁЭРТЁЭРЛЁЭРАЁЭРМ
ЁЯМЯ ЁЭРВЁЭРлЁЭРЮЁЭРЪЁЭРнЁЭЧ╝ЁЭЧ┐ тФБ ЁЭРТЁЭРЪЁЭРвЁЭРЯЁЭРоЁЭРе ЁЭРИЁЭРмЁЭРеЁЭРЪЁЭРж ЁЯМЯ` },

    "ржЖрж╕рж░": { time: "16:21", msg: 
`тХФтХРтЭЦЁЯМЗтЭЦтХРтХЧ
ЁЯХМ ржЖрж╕рж░ ржирж╛ржорж╛ржЬ
тХЪтХРтЭЦЁЯМЗтЭЦтХРтХЭ
тП░ рж╕ржоржпрж╝ рж╢рзЗрж╖ рж╣рждрзЗ ржЪрж▓рзЗржЫрзЗ! ржЖрж╕рж░рзЗрж░  ржирж╛ржорж╛ржЬрзЗрж░ ржЬржирзНржп ржкрзНрж░рж╕рзНрждрзБржд рж╣рзЛржиред
ЁЯССЁЭРБЁЭРиЁЭРн ЁЭРОЁЭР░ЁЭРзЁЭРЮЁЭРл тЮа ЁЭРТЁЭРАЁЭРИЁЭРЕЁЭРФЁЭРЛ ЁЭРИЁЭРТЁЭРЛЁЭРАЁЭРМ
ЁЯМЯ ЁЭРВЁЭРлЁЭРЮЁЭРЪЁЭРнЁЭЧ╝ЁЭЧ┐ тФБ ЁЭРТЁЭРЪЁЭРвЁЭРЯЁЭРоЁЭРе ЁЭРИЁЭРмЁЭРеЁЭРЪЁЭРж ЁЯМЯ` },

    "ржорж╛ржЧрж░рж┐ржм": { time: "17:51", msg: 
`тХФтХРтЭЦЁЯМЩтЭЦтХРтХЧ
ЁЯХМ ржорж╛ржЧрж░рж┐ржм ржирж╛ржорж╛ржЬ
тХЪтХРтЭЦЁЯМЩтЭЦтХРтХЭ
тП░ рж╕ржоржпрж╝ рж╢рзЗрж╖ рж╣рждрзЗ ржЪрж▓рзЗржЫрзЗ! ржорж╛ржЧрж░рж┐ржмрзЗрж░  ржирж╛ржорж╛ржЬрзЗрж░ ржЬржирзНржп ржкрзНрж░рж╕рзНрждрзБржд рж╣рзЛржиред
ЁЯССЁЭРБЁЭРиЁЭРн ЁЭРОЁЭР░ЁЭРзЁЭРЮЁЭРл тЮа ЁЭРТЁЭРАЁЭРИЁЭРЕЁЭРФЁЭРЛ ЁЭРИЁЭРТЁЭРЛЁЭРАЁЭРМ
ЁЯМЯ ЁЭРВЁЭРлЁЭРЮЁЭРЪЁЭРнЁЭЧ╝ЁЭЧ┐ тФБ ЁЭРТЁЭРЪЁЭРвЁЭРЯЁЭРоЁЭРе ЁЭРИЁЭРмЁЭРеЁЭРЪЁЭРж ЁЯМЯ` },

    "ржЗрж╢рж╛": { time: "19:24", msg: 
`тХФтХРтЭЦЁЯММтЭЦтХРтХЧ
ЁЯХМ ржЗрж╢рж╛ ржирж╛ржорж╛ржЬ
тХЪтХРтЭЦЁЯММтЭЦтХРтХЭ
тП░ рж╕ржоржпрж╝ рж╢рзЗрж╖ рж╣рждрзЗ ржЪрж▓рзЗржЫрзЗ! ржЗрж╢рж╛рж░ ржирж╛ржорж╛ржЬрзЗрж░ ржЬржирзНржп ржкрзНрж░рж╕рзНрждрзБржд рж╣рзЛржиред
ЁЯССЁЭРБЁЭРиЁЭРн ЁЭРОЁЭР░ЁЭРзЁЭРЮЁЭРл тЮа ЁЭРТЁЭРАЁЭРИЁЭРЕЁЭРФЁЭРЛ ЁЭРИЁЭРТЁЭРЛЁЭРАЁЭРМ
ЁЯМЯ ЁЭРВЁЭРлЁЭРЮЁЭРЪЁЭРнЁЭЧ╝ЁЭЧ┐ тФБ ЁЭРТЁЭРЪЁЭРвЁЭРЯЁЭРоЁЭРе ЁЭРИЁЭРмЁЭРеЁЭРЪЁЭРж ЁЯМЯ` }
  };

  // ржкрзНрж░рждрж┐ржжрж┐ржирзЗрж░ ржУрзЯрж╛ржХрзНржд
  for (let [prayer, { time, msg }] of Object.entries(prayerTimes)) {
    const [hour, minute] = time.split(":").map(Number);

    const job = schedule.scheduleJob({ hour, minute, tz: "Asia/Dhaka" }, function () {
      const today = new Date();
      const day = today.getDay(); // Sunday = 0 ... Friday = 5

      // рж╢рзБржХрзНрж░ржмрж╛рж░ рж╣рж▓рзЗ ржпрзЛрж╣рж░ рж╕рзНржХрж┐ржк рж╣ржмрзЗ
      if (day === 5 && prayer === "ржпрзЛрж╣рж░") return;

      for (const threadID of global.data.allThreadID) {
        api.sendMessage(msg, threadID);
      }
    });

    jobs.push(job);
  }

  // ржЬрзБржорж╛рж░ ржирж╛ржорж╛ржЬ (рж╢рзБржзрзБ рж╢рзБржХрзНрж░ржмрж╛рж░ 13:28 ржП)
  const jumuahJob = schedule.scheduleJob({ dayOfWeek: 5, hour: 12, minute: 45, tz: "Asia/Dhaka" }, function () {
    const jumuahMsg = 
`тХФтХРтЭЦЁЯХМтЭЦтХРтХЧ
тЬи ржЬрзБржорж╛рж░ ржирж╛ржорж╛ржЬ тЬи
тХЪтХРтЭЦЁЯХМтЭЦтХРтХЭ
тЬи ржорж╛рждрзНрж░ ржХржпрж╝рзЗржХ ржорзБрж╣рзВрж░рзНржд ржмрж╛ржХрж┐тАж ржПржЦржирж┐ ржиржд рж╣ржЗ ржЬрзБржорж╛рж░ ржирж╛ржорж╛ржЬрзЗред
ЁЯССЁЭРБЁЭРиЁЭРн ЁЭРОЁЭР░ЁЭРзЁЭРЮЁЭРл тЮа ЁЭРТЁЭРАЁЭРИЁЭРЕЁЭРФЁЭРЛ ЁЭРИЁЭРТЁЭРЛЁЭРАЁЭРМ
ЁЯМЯ ЁЭРВЁЭРлЁЭРЮЁЭРЪЁЭРнЁЭЧ╝ЁЭЧ┐ тФБ ЁЭРТЁЭРЪЁЭРвЁЭРЯЁЭРоЁЭРе ЁЭРИЁЭРмЁЭРеЁЭРЪЁЭРж ЁЯМЯ`;

    for (const threadID of global.data.allThreadID) {
      api.sendMessage(jumuahMsg, threadID);
    }
  });

  jobs.push(jumuahJob);

  console.log("тЬЕ ржирж╛ржорж╛ржЬ ржирзЛржЯрж┐ржлрж┐ржХрзЗрж╢ржи рж╕рж┐рж╕рзНржЯрзЗржо ржЪрж╛рж▓рзБ рж╣рзЯрзЗржЫрзЗ (рзл ржУрзЯрж╛ржХрзНржд + ржЬрзБржорж╛)ред");
};

module.exports.run = async function() {
  // ржХрзЛржирзЛ ржХржорж╛ржирзНржб ржжрж░ржХрж╛рж░ ржирзЗржЗ, ржЕржЯрзЛ ржЪрж▓ржмрзЗ
};
